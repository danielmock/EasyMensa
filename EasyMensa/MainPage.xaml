<Page x:Class="EasyMensa.MainPage"
	  xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
	  xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
	  xmlns:local="using:EasyMensa"
	  xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
	  xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
	  mc:Ignorable="d"
	  xmlns:models="using:EasyMensa.Models"
	  xmlns:converters="using:EasyMensa.Converters">

	<Page.Resources>
		<DataTemplate x:Key="MealTemplate"
					  x:DataType="models:Meal">
			<Grid>
				<Grid.RowDefinitions>
					<RowDefinition />
					<RowDefinition />
				</Grid.RowDefinitions>
				<Grid.ColumnDefinitions>
					<ColumnDefinition Width="*" />
					<ColumnDefinition Width="Auto" />
				</Grid.ColumnDefinitions>
				<TextBlock x:Name="CategoryNameBlock"
						   Text="{x:Bind Category}" />
				<TextBlock Grid.Column="1"
						   Text="{x:Bind Prices.Students}"
						   Margin="0,0,0.333,0" />
				<TextBlock Grid.Row="1"
						   Grid.ColumnSpan="2"
						   Text="{x:Bind Name}" 
						   />
			</Grid>
		</DataTemplate>

		<converters:DecimalToCurrencyConverter x:Key="DecimalToCurrencyConverter" />
	</Page.Resources>

	<Grid Background="{ThemeResource ApplicationPageBackgroundThemeBrush}">
		<Grid.RowDefinitions>
			<RowDefinition Height="Auto" />
			<RowDefinition Height="*" />
		</Grid.RowDefinitions>

		<!-- Title Bar -->
		<StackPanel Padding="0"
					Background="{ThemeResource AppBarBackgroundThemeBrush}">
			<TextBlock Style="{ThemeResource TitleTextBlockStyle}"
					   Margin="5,0,0,0">Mensa Academica</TextBlock>
		</StackPanel>

		<!-- Pivot -->
		<Pivot Grid.Row="1"
			   ItemsSource="{x:Bind MensaAcademica.Days}">
			<Pivot.HeaderTemplate>
				<DataTemplate x:DataType="models:MensaDay">
					<StackPanel>
						<TextBlock Text="{x:Bind WeekDayName}"
								   Style="{ThemeResource TitleTextBlockStyle}" />
						<TextBlock Text="{x:Bind Date}"
								   Style="{ThemeResource CaptionTextBlockStyle}" />
					</StackPanel>
				</DataTemplate>
			</Pivot.HeaderTemplate>
			
			<Pivot.ItemTemplate>
				<DataTemplate x:DataType="models:MensaDay">
					<ListView ItemsSource="{x:Bind Meals}">
						<ListView.ItemTemplate>
							<DataTemplate x:DataType="models:Meal">
								<Grid>
									<Grid.RowDefinitions>
										<RowDefinition />
										<RowDefinition />
										<RowDefinition />
									</Grid.RowDefinitions>
									<Grid.ColumnDefinitions>
										<ColumnDefinition Width="*" />
										<ColumnDefinition Width="Auto" />
									</Grid.ColumnDefinitions>
									<TextBlock x:Name="CategoryNameBlock"
											   Text="{x:Bind Category}"
											   Style="{StaticResource CaptionTextBlockStyle}" />
									<TextBlock Grid.Column="1"
											   Text="{x:Bind Prices.Students, Converter={StaticResource DecimalToCurrencyConverter}}"
											   Style="{StaticResource CaptionTextBlockStyle}" 
											   Foreground="{ThemeResource SystemControlForegroundAccentBrush}"/>
									<TextBlock Grid.Row="1"
											   Grid.ColumnSpan="2"
											   Text="{x:Bind Name}" />
									<TextBlock Grid.Row="2"
											   Grid.ColumnSpan="2"
											   Text="{x:Bind Description}" />
								</Grid>
							</DataTemplate>
						</ListView.ItemTemplate>
						
						<!-- Stretches DataTemplate -->
						<ListView.ItemContainerStyle>
							<Style TargetType="ListViewItem">
								<Setter Property="HorizontalAlignment" Value="Stretch" />
								<Setter Property="HorizontalContentAlignment"
										Value="Stretch" />
							</Style>
						</ListView.ItemContainerStyle>
					</ListView>
				</DataTemplate>
			</Pivot.ItemTemplate>
			
			<!--<Pivot.ItemContainerStyle>
				<Style TargetType="PivotItem">
					<Setter Property="HorizontalAlignment"
							Value="Stretch" />
				</Style>
			</Pivot.ItemContainerStyle>-->
		</Pivot>
	</Grid>
</Page>
